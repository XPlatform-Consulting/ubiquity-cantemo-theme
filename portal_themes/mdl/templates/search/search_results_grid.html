{% themeextends "search/base_search_results.html" %}

{% load i18n paginator getstring cache %}
{% qstring as current_qstring %}

{% comment %}
{% block title %}{% trans "Search" %} {{ searchquery }}{% endblock title %}

{% block heading %}
	{% themeinclude "search/search_results_form.html" %}
{% endblock heading %}
{% endcomment %}

{% block drawer %}
	<div class="mdl-layout__drawer">
		{% themeinclude "search/search_results_sidebar.html" %}
	</div>
{% endblock drawer %}

{% block content %}
<!-- search_results_grid.html -->

<div id="results-container" class="mdl-grid">
	{% if hits %}
		{% for item in items  %}
			{% if item.getItemType == 'SubClip' %}
				{% url item_subclip item.parent_id '0' item.getId as item_URL %}

				{% with item.item as parentitem %}
					{% with item as annotation %}
						{% themeinclude 'media/media_inc_preview.html' %}
					{% endwith %}
				{% endwith %}
			{% else %}
				{% url vs_item item.getId as item_URL  %}

				{% with item.item as parentitem %}
					{% themeinclude 'media/media_inc_preview.html' %}
				{% endwith %}
			{% endif %}
		{% endfor %}

		<div id="sr_load_more" class="sr_load_more">
			<p><a href="#sr_load_more" id="sr_load_more_lnk">{% trans "Load more results" %}</a></p>
		</div>
	{% else %}

		<h2>{% trans "No media found." %}</h2>

		<p style="font-size:1.3em;">
			{% if searchquery == "" %}
				{% blocktrans %}We couldn't find any media matching your search query, {% endblocktrans %}
			{% else %}
				{% blocktrans %}We couldn't find any media matching the query term "{{ searchquery }}", {% endblocktrans %}
			{% endif %}

			{% if suggestions and searchquery != "" %}
				{% trans "did you mean" %}
				{% for suggestion in suggestions %}
			 		<a href="{{ request.path }}{{ current_qstring|qstring_del:'searchquery' }}&amp;searchquery={{ suggestion|urlencode }}">{{ suggestion }}</a>{% if not forloop.last %}{% if forloop.revcounter == 2 %} {% trans "or" %} {% else %},{% endif %} {% endif %}{% endfor %}?
			{% else %}
				{% trans "please try again." %}
			{% endif %}
		</p>
	{% endif %}
</div><!-- #results-container -->

<div class="centerwrapper">
	{% if hits %}
        {% paginator 2 %}
	{% endif %}
</div><!-- .centerwrapper -->
{% endblock content %}

{% docstring %}
search_results_grid.html is shown for general search results. Has a list of items.

The list of items is normal items unless the user has search for SubClips - timed annotation metadata, then the individual pods are annotations.

Context:
 * items - list of search result items.
 * hits - Amount of search results in total.
 * searchquery - search query in the system.
 * history - Search history
 * first_on_page - number from 0 of the first item on page
 * has_next - has a next page
 * has_other_pages - has other pages
 * last_on_page - last on page
 * library - Vidispine library ID
 * next - Next page number
 * page - Current page
 * pages - Total number of pages
 * results_per_page - Results to show on page.
{% enddocstring %}
